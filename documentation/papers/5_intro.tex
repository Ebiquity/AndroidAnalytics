\section{Introduction}
\label{intro}
Mobile devices have become ubiquitous due to its low cost and Android is the biggest player in the market. Latest reports from Google boasts of more than a billion active 30 day user~\cite{Engadget_market_share}. According to the International Data Corporation's Worldwide Quarterly Mobile Phone Tracker report Android has a 85\% market share in the smartphone category. Apps from the Google Play Store and a variety of other app-stores like Amazon App Store and Samsung Galaxy Apps provide a plethora of ways through which Android users can get their apps~\cite{Online_App_Stores}. According to Statista~\cite{Android_app_number}, as of July 2015, there are more than 1.6 million android apps in the Google Play Store. 

The proliferation of smartphones has led to the popularity of the BYOD(Bring-Your-Own-Device) paradigm, whereby users' use their personal devices for corporate purposes. Naturally, this creates a greater need to ensure strong access control mechanisms for the data on such devices. In certain domains the access control needs are of a critical nature. For example in the category of Medical and Health \& fitness apps it is essential that user data and if being used in hospitals, corporate data security be maintained to the utmost level. Hospitals today use various hardware devices that are smart enough to communicate with smartphones and may even contain sensitive medical data. In addition to that android apps are capable of collecting a huge amounts of data about the smartphone user, often without the knowledge of the user. 

In this paper, we introduce Heimdall~\footnote{Heimdall is the all-seeing and all-hearing guardian sentry of Asgard who stands on the rainbow bridge Bifr\"{o}st to watch for any attacks on Asgard}, a heuristics based system that is currently in-the-works in our group. Heimdall is capable of detecting common vulnerabilities on an android device that can cause leakage of app data. Heimdall has been created with a BYOD scenario in mind where a part of the system resides on the mobile device and part of it resides on the server side. The server side includes a dashboard that gets notifications of apps being installed on the mobile devices used by the employees of the organization. The system is then able to analyze and detect if the app is vulnerable with respect to a list of previously known heuristics. We are adding new heuristics as we discover and study them. \hl{We are also including mechanisms to prevent data leakages by injecting code into the android framework which would allow us to intervene in the permission check process and thereby control the actual data flow on the phone.}

For the current paper we have focused on vulnerability in custom permissions created by app developers. These permissions are there to protect the app developers' data available through their own content providers. It is advised by Google that, if an app developer creates a content provider for allowing access to there own data, they should also create a permission to control access to it. However, this requirement is not a stringent one and one might simply ignore creating such a permission. We show in this paper how such a vulnerability might lead to leakage of app data. We use two different mechanisms to demonstrate the issue. We show that it is possible to exploit this vulnerability using our own data access app and content provider app pair. We also show that it's possible to reverse engineer and repackage any standard app to create this vulnerability. We did observe that it is possible to check for this issue in your code instead of delegating this issue to android but through our evaluation we show that such a check might be beyond standard practices. 

Previous work found in the literature points out the extensive research that has gone into various mechanisms to study vulnerabilities in android apps. The mechanisms have ranged from app metadata analysis by Pandita et. al.~\cite{Pandita2013Whyper}, to detecting malwares by studying their characteristics like installation methods, activation mechanisms and malicious payload nature by Zhou et.al.~\cite{Zhou2012MalwareGenomeProject}. Such studies indicate a need for better mobile anti-malware solutions and access control mechanisms. There have been multiple attempts at achieving the goal of properly managing access control on mobile (Android) devices. Efforts have been made by the open source community through the XPrivacy project (needs a rooted phone), the Privacy Guard project (available on Cyanogenmod, a custom Android ROM), the PDroid application (needs a rooted device). Research project by Conti et. al.~\cite{conti2011crepe}(CRePe), Enck et al.~\cite{enck2010taintdroid}(TaintDroid) and Jagtap et al.~\cite{Jagtap2011Privacy}(Preserving Privacy in Context-Aware Systems) have made similar efforts. CRePE described a system where security policy enforcement was carried out based on context of the smart phone. TaintDroid was a research effort where the data flow on an Android device was studied to figure out when sensitive data left the system via an untrusted application. The work of Jagtap et al.~\cite{Jagtap2011Privacy} focused on constraining data flow in a context-aware system using a policy-based framework. A related work by Ghosh et al.~\cite{ghosh2012privacy} used a similar policy driven approach to constrain application permissions based on context. 

We can understand from the extensive work done that there is significant knowledge about vulnerabilities on Android and ways to detect them. In this paper we present Heimdall, a system which can detect such vulnerabilities and we show an example of how one of these vulnerabilities can be detected using our system. The rest of the paper is organized as follows. We describe our system overview in the section 2. That is followed by a description of the problem at hand in section 3. We also present a way such a loophole can be introduced in any android app in this section. We present a working prototype that is capable of detecting such a vulnerability in section 4. We conclude the paper with a discussion of related work in section 5 and future research directions that can lead to more vulnerability discoveries in section 6.

%Given the abundance of works in the access control area, its understandable that the latest version of Android (Marhsmallow), embraced a new permission model. Android now boasts of a runtime, on-demand permission acquisition model, similar to iOS, the other leading smartphone platform. Such a change, although welcome, still remains inadequate with respect to context based data flow control. Android has attempted to make the transition for its developers and users simple by grouping the control into logical groups but it still leaves a lot to desire.

%Some of them include Blood glucose monitoring system[5], Blood pressure monitor[6], Heart monitor[7], Fitness accessories like Fitbit, Breathalyzer[4] etc. All these accessories have an associated Android application which interacts with the physical device, process the data, display it and stores relevant information. Another category of applications are those used by hospitals and its employees to manage information about the patients, doctors etc. The important point is that all these sensitive information are being received, processed, stored and possibly updated to cloud storage by these applications. The fact that personal and sensitive data is handled by these devices presents a potential security risk. With more than 1.6 million apps to choose from, let alone a layman user, even a computer expert will have difficulty to understand what are benign and what are malicious. One of the most traditional ways to look at this problem is to use signature based malware detection, in which once a malware application is detected, signature will be created once and the signatures are updated to a common database. Any future appearance of the same malware would be detected using these signatures. The classical problem with this approach is the occurrence of mutating malwares which changes it’s signature every time it is spread and it inability to detect future similar attacks. Apart from this Android apps has issues on its own. One of the main problem is the high volatility of the app markets. Since unlike Apple store, Google play store is not verified and hence new applications becomes available and taken out quite frequently. Yet another issue is repackaging popular application with malware. Often these repackaged applications are uploaded to other local App-stores where the original application is not available. Hence we require a faster and dynamic setup to detect unsafe or rather potentially unsafe applications. [Paper to be referred Dr B]Even though not totally accurate, there are some intuitions which we can utilize from the meta-data available with each application. The different meta-data available with each of these applications include App description, Permissions required, Number of downloads, Broad Application categories etc. As an example of our intuition let us take the case of “brightestlight” application, which is available in Google Play Store. The description of the application says that it is a flash light app, which shows some unobtrusive Ads. But on analyzing the Permissions required, we can see that the application requests permissions for location (accurate GPS and approximate network based), file manipulation (read, modify and delete USB storage), camera (curiously it includes auto-focus permission) etc. This does seem suspicious. But still we cannot say that the application is unsafe, rather we need further investigation.